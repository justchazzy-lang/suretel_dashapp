<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Surtel Recording Puller</title>
</head>
<body>
    <h2>Surtel Recording Downloader</h2>

    <!-- Input fields for destination and dates -->
    <label>Destination Number:</label><br>
    <input type="text" id="destination"><br><br>

    <label>Start Date (YYYY-MM-DD):</label><br>
    <input type="date" id="startDate"><br><br>

    <label>End Date (YYYY-MM-DD):</label><br>
    <input type="date" id="endDate"><br><br>

    <button onclick="sendRequest()">Pull Recordings</button>

    <p id="response"></p>

    <script>
        // Function that sends a POST request to the Flask backend
        async function sendRequest() {
            const destination = document.getElementById("destination").value;
            const start = document.getElementById("startDate").value;
            const end = document.getElementById("endDate").value;
            document.getElementById("response").innerText = "⏳ Pulling recordings — server will respond when done...";
            
            try {
                // Sending data to the backend '/pull' route
                const res = await fetch("http://127.0.0.1:5000/pull", { // Update with your correct server address
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ destination, start_date: start, end_date: end })
                });
                
                // Wait for the server's response and show it
                const data = await res.json();
                document.getElementById("response").innerText = "Status: " + data.status;
            } catch (err) {
                // If the request fails, display the error
                document.getElementById("response").innerText = "Request failed: " + err;
            }
        }
    </script>

</body>
</html>

